{"ast":null,"code":"import{GET_CURRENT_USER,SET_CURRENT_USER,GET_ERRORS,API_URL}from'../constants/constants';import axios from'axios';import jwtDecode from'jwt-decode';import setHeader from'../../helpers/setHeader';import{toast}from'react-toastify';import\"react-toastify/dist/ReactToastify.css\";import{getCartInfo}from'./CartActions';var token=localStorage.getItem('token');var headers={Authorization:\"Bearer \".concat(token)};export var setCurrentUser=function setCurrentUser(user){return{type:SET_CURRENT_USER,payload:user};};export var getCurrentUser=function getCurrentUser(){var token=localStorage.getItem('token');setHeader(token);var headers={Authorization:\"Bearer \".concat(token)};return function(dispatch){axios({method:\"GET\",headers:headers,url:\"\".concat(API_URL,\"/api/auth/info\")}).then(function(res){dispatch({type:GET_CURRENT_USER,payload:res.data});}).catch(function(err){console.log(err);});};};export var getUserLogin=function getUserLogin(){var token=localStorage.getItem('token');setHeader(token);var headers={Authorization:\"Bearer \".concat(token)};return axios({method:\"GET\",headers:headers,url:\"\".concat(API_URL,\"/api/auth/info\")});};export var getErrors=function getErrors(errors){return{type:GET_ERRORS,payload:errors};};export var login=function login(user,history){var username=user.username,password=user.password;return function(dispatch){axios({method:'POST',url:\"\".concat(API_URL,\"/api/auth/login\"),data:{username:username,password:password}}).then(function(res){var token=res.data.token;var username=res.data.username;localStorage.setItem('token',token);localStorage.setItem('username',username);var decoded=jwtDecode(token);dispatch(setCurrentUser(decoded));dispatch(getCartInfo());history.goBack();}).catch(function(err){toast.error('Tài khoản hoặc mật khẩu không chính xác!',{position:\"bottom-center\",theme:'dark',autoClose:2000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});console.log(err);});};};export var register=function register(data,history){return function(dispatch){axios({method:\"POST\",data:JSON.stringify(data),url:\"\".concat(API_URL,\"/api/auth/register\"),headers:{'content-type':'application/json'}}).then(function(res){toast.success(res.data.message,{position:\"bottom-center\",autoClose:1500,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});history.push(\"/login\");}).catch(function(err){if(err){toast.error(err.response.data.message,{position:\"bottom-center\",theme:'dark',autoClose:2000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});dispatch(getErrors(err.response.data.message));}});};};export var updateInfo=function updateInfo(data){return axios({method:\"PUT\",url:\"\".concat(API_URL,\"/api/auth/update-info\"),headers:headers,data:data});};export var updatePassword=function updatePassword(data){return axios({method:\"PUT\",url:\"\".concat(API_URL,\"/api/auth/update-password\"),headers:headers,data:data});};export var logout=function logout(){return function(dispatch){localStorage.removeItem(\"token\");localStorage.removeItem(\"username\");dispatch(setCurrentUser({}));window.location.reload();setHeader();};};","map":{"version":3,"names":["GET_CURRENT_USER","SET_CURRENT_USER","GET_ERRORS","API_URL","axios","jwtDecode","setHeader","toast","getCartInfo","token","localStorage","getItem","headers","Authorization","concat","setCurrentUser","user","type","payload","getCurrentUser","dispatch","method","url","then","res","data","catch","err","console","log","getUserLogin","getErrors","errors","login","history","username","password","setItem","decoded","goBack","error","position","theme","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","register","JSON","stringify","success","message","push","response","updateInfo","updatePassword","logout","removeItem","window","location","reload"],"sources":["D:/TutuFinal/tutuClient/src/actions/services/UserActions.js"],"sourcesContent":["import {\r\n    GET_CURRENT_USER, SET_CURRENT_USER, GET_ERRORS, API_URL\r\n} from '../constants/constants'\r\n\r\nimport axios from 'axios'\r\nimport jwtDecode from 'jwt-decode'\r\nimport setHeader from '../../helpers/setHeader'\r\nimport { toast } from 'react-toastify'\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport { getCartInfo } from './CartActions'\r\nconst token = localStorage.getItem('token');\r\nconst headers = { Authorization: `Bearer ${token}` }\r\n\r\nexport const setCurrentUser = (user) => {\r\n    return {\r\n        type: SET_CURRENT_USER,\r\n        payload: user\r\n    }\r\n}\r\n\r\nexport const getCurrentUser = () => {\r\n    const token = localStorage.getItem('token');\r\n    setHeader(token);\r\n    const headers = { Authorization: `Bearer ${token}` }\r\n    return dispatch => {\r\n        axios({\r\n            method: \"GET\",\r\n            headers: headers,\r\n            url: `${API_URL}/api/auth/info`\r\n        })\r\n            .then((res) => {\r\n                dispatch({\r\n                    type: GET_CURRENT_USER,\r\n                    payload: res.data\r\n                });\r\n            })\r\n            .catch((err) => {\r\n                console.log(err);\r\n            })\r\n    }\r\n}\r\n\r\nexport const getUserLogin = () => {\r\n    const token = localStorage.getItem('token');\r\n    setHeader(token);\r\n    const headers = { Authorization: `Bearer ${token}` }\r\n    return axios({\r\n        method: \"GET\",\r\n        headers: headers,\r\n        url: `${API_URL}/api/auth/info`\r\n    })\r\n}\r\n\r\n\r\nexport const getErrors = (errors) => {\r\n    return {\r\n        type: GET_ERRORS,\r\n        payload: errors\r\n    }\r\n}\r\n\r\nexport const login = (user, history) => {\r\n    const { username, password } = user;\r\n    return dispatch => {\r\n        axios({\r\n            method: 'POST',\r\n            url: `${API_URL}/api/auth/login`,\r\n            data: { username, password }\r\n        })\r\n            .then((res) => {\r\n                const token = res.data.token;\r\n                const username = res.data.username;\r\n                localStorage.setItem('token', token);\r\n                localStorage.setItem('username', username);\r\n                const decoded = jwtDecode(token);\r\n                dispatch(setCurrentUser(decoded));\r\n                dispatch(getCartInfo());\r\n                history.goBack();\r\n            })\r\n            .catch(err => {\r\n                toast.error('Tài khoản hoặc mật khẩu không chính xác!', {\r\n                    position: \"bottom-center\",\r\n                    theme: 'dark',\r\n                    autoClose: 2000,\r\n                    hideProgressBar: false,\r\n                    closeOnClick: true,\r\n                    pauseOnHover: true,\r\n                    draggable: true,\r\n                    progress: undefined,\r\n                });\r\n                console.log(err);\r\n            })\r\n    }\r\n}\r\n\r\nexport const register = (data, history) => {\r\n    return dispatch => {\r\n        axios({\r\n            method: \"POST\",\r\n            data: JSON.stringify(data),\r\n            url: `${API_URL}/api/auth/register`,\r\n            headers: {\r\n                'content-type': 'application/json'\r\n            }\r\n        })\r\n            .then((res) => {\r\n                toast.success(res.data.message, {\r\n                    position: \"bottom-center\",\r\n                    autoClose: 1500,\r\n                    hideProgressBar: false,\r\n                    closeOnClick: true,\r\n                    pauseOnHover: true,\r\n                    draggable: true,\r\n                    progress: undefined,\r\n                });\r\n                history.push(\"/login\")\r\n            })\r\n            .catch((err) => {\r\n                if (err) {\r\n                    toast.error(err.response.data.message, {\r\n                        position: \"bottom-center\",\r\n                        theme: 'dark',\r\n                        autoClose: 2000,\r\n                        hideProgressBar: false,\r\n                        closeOnClick: true,\r\n                        pauseOnHover: true,\r\n                        draggable: true,\r\n                        progress: undefined,\r\n                    });\r\n                    dispatch(getErrors(err.response.data.message))\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport const updateInfo = (data) => {\r\n    return axios({\r\n        method: \"PUT\",\r\n        url: `${API_URL}/api/auth/update-info`,\r\n        headers: headers,\r\n        data: data\r\n    })\r\n}\r\n\r\nexport const updatePassword = (data) => {\r\n    return axios({\r\n        method: \"PUT\",\r\n        url: `${API_URL}/api/auth/update-password`,\r\n        headers: headers,\r\n        data: data\r\n    })\r\n}\r\n\r\nexport const logout = () => {\r\n    return dispatch => {\r\n        localStorage.removeItem(\"token\");\r\n        localStorage.removeItem(\"username\");\r\n        dispatch(setCurrentUser({}));\r\n        window.location.reload();\r\n        setHeader();\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}